# -*- coding: utf-8 -*-
"""water quality prediction 1.csv

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RCc_qw7zFAWj63g_8KIupGmA_NZbKOA-
"""

from google.colab import files
uploaded = files.upload()

import pandas as pd
df = pd.read_csv('PB_All_2000_2021.csv')
print(df.head())

from google.colab import drive
drive.mount('/content/drive')

pip install pandas numpy matplotlib seaborn scikit-learn

import pandas as pd
import numpy as np
from sklearn.multioutput import MultiOutputRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error,r2_score

df=pd.read_csv('PB_All_2000_2021.csv',sep=';')
df

df.info()

df.shape

df.describe()

df.describe().T #transpose rows to columns

df.head()             # Show first 5 rows
df.tail()             # Show last 5 rows
df.sample(5)          # Random 5 rows

df.info()             # Summary of dataset (non-null count, data types)
df.columns            # List of column names
df.index              # Show the index range

df.duplicated().sum()  # Count duplicate rows
df[df.duplicated()]    # Show duplicate rows

df.isnull().sum()

#date is in object(string) converting it into date format
df['date']=pd.to_datetime(df['date'], format='%d.%m.%Y')
df

df.info()

#sorting data
df=df.sort_values(by=['id','date'])
df.head()

df['year']=df['date'].dt.year
df['month']=df['date'].dt.month
df.head()

df.head(100)

df.columns

pollutants=['O2', 'NO3', 'NO2', 'SO4',
       'PO4', 'CL']

import os

# List all files in the current working directory
for file in os.listdir():
    print(file)

df.to_csv('my_water_data.csv', index=False)
files.download('my_water_data.csv')